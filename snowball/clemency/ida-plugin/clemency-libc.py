import idaapi
from idaapi import *

LIBC_FUNCS = {
    'malloc': '0000 0000 00C0 0000 004B 0006 0051 000B 0010 0051',
    'free': '0004 0159 0000 0000 0000 0000 0042 0159',
    'send': '0040 00C4 0158 0000 0080',
    'recv': '0120 0000 0000 0140 0108 0070 0080 0148 0158',
    'memset': '00C0 0060 0000 0102 0100 0048 0048',
    'strlen': '0040 0060 0000 0084 0070 0040 0082',
    'memcpy': '0000 0181 0015 0102 0158 0008 0000 0000',
    'strncmp': '0017 0080 0172 0000 0100 0180 0021 0084 0010 000A 0064 0170 01FF',
    'atoi': '0000 0151 0000 0000 0000 0000 01D0 0140 0100 0100 0172 002D 0100 0180 0018',
    'fflush': '0000 0120 0172 0000 0100 0186 0009 0000 0120 0000 0100 0187 0036 0010 0060 0101',
    'strncpy': '010A 0170 0100 0185 0006 0014 0061 0141 0090 0060 0101 0056 0060 0161 0012 0060',
    'strcmp': '0100 0180 001E 0064 0170 01FF 0180 01E6 0000 0181 0011 0000',
    'isspace': '0000 0172 0020 0100 0180 0009 0100 0120 0000 0100 0187 0009 0000 0124 0001 0050 0060 0101 0002 0060 0021 003A 0159 0008 0000 0000 0000 0138 015B 0040 0000 0000',
    'isalpha': '0140 013A 016B 0050 0000 0000 0000 013B 0063 01A1 017A 0013 0033 003A 0169 0050 0000 0000 0000 0001 0011 000B 0100 0172 001A 0100 0124',
    'printf': '0168 00F0 0000 0000 0000 013A 016B 0050 0000 0000 0000 013B 0063 01A1 017A 0013 007B 003A 0169 0070 0000 0000 0000 0038 0001 0063 0100 0124 013D 0100 0114 0025',
    'strcpy': '0000 000A 0000 0172 0003 0000 0181 0015 0048 0158 0008 0000 0000 0000',
}

for x in LIBC_FUNCS:
    ea = find_binary(0, SegEnd(0), LIBC_FUNCS[x], 16, SEARCH_DOWN)
    if ea == 0xFFFFFFFF:
        continue
    ea = FirstFuncFchunk(ea + 4)
    MakeName(ea, x)
